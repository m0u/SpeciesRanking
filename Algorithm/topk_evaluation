#### Algorithm: Top-K Agreement Between True and Predicted Rankings

**Input:**
- Excel file `RANK.xlsx` with multiple ground-truth sheets  
- Excel file `predicted_ranks.xlsx` with prediction sheets  
- Set of K values (e.g., K = 5 and K = 10)

**Steps:**

1. **Load ground-truth rankings**
   - Open `RANK.xlsx` as an Excel workbook.
   - For each sheet:
     - Read it into a DataFrame.
     - Set `Group name` as the index.
     - Store in a dictionary: `rank_sheets[ground_truth_name]`.

2. **Load predicted rankings**
   - Open `predicted_ranks.xlsx`.
   - For each prediction sheet (`graph`, `regression`, `gcn`, `gcn_reg`):
     - Read into a DataFrame.
     - Set `Species` as the index.
     - Store in a dictionary: `pred_sheets[prediction_name]`.

3. **Define Top-K agreement function**
   - Given a ground-truth DataFrame `true_df` and predicted DataFrame `pred_df`:
     - Sort both by `Rank` in ascending order.
     - Take the top-K indices (species names) from each.
     - Compute the overlap between the two sets.
     - Top-K Agreement = `|overlap| / K`.

4. **Evaluate all ground truth Ã— prediction pairs**
   - For each ground-truth sheet `gt_name` in `rank_sheets`:
     - For each prediction `pred_name` in `pred_sheets`:
       - Compute Top-5 agreement and overlapping species.
       - Compute Top-10 agreement and overlapping species.
       - Append a result record:
         - `Ground Truth`, `Prediction`,
         - `Top-5 Agreement`, `Top-5 Overlap`,
         - `Top-10 Agreement`, `Top-10 Overlap`.

5. **Aggregate and save results**
   - Convert the list of result records into a DataFrame `results_df`.
   - Print `results_df` to the console.
   - Save `results_df` to `top_k_similarity_results.csv`.

**Output:**
- CSV file `top_k_similarity_results.csv` summarising:
  - Ground truth sheet name
  - Prediction method
  - Top-5 and Top-10 agreement scores
  - Exact overlapping species in Top-5 and Top-10
